var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},__extends=function(t,e){function n(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},__assign=Object.assign||function(t){for(var e,n=1,i=arguments.length;i>n;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},__rest=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n},__decorate=function(t,e,n,i){var r,o=arguments.length,s=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(3>o?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},__param=function(t,e){return function(n,i){e(n,i,t)}},__metadata=function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},__awaiter=function(t,e,n,i){function r(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,o){function s(t){try{u(i.next(t))}catch(e){o(e)}}function a(t){try{u(i["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):r(t.value).then(s,a)}u((i=i.apply(t,e||[])).next())})},__generator=function(t,e){function n(t){return function(e){return i([t,e])}}function i(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&n[0]?o["return"]:n[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(i){n=[6,i],o=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,o,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},__exportStar=function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||__createBinding(e,t,n)},__createBinding=Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]},__values=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),s=[];try{for(;(void 0===e||e-->0)&&!(i=o.next()).done;)s.push(i.value)}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o["return"])&&n.call(o)}finally{if(r)throw r.error}}return s},__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(__read(arguments[e]));return t},__spreadArrays=function(){for(var t=0,e=0,n=arguments.length;n>e;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;n>e;e++)for(var o=arguments[e],s=0,a=o.length;a>s;s++,r++)i[r]=o[s];return i},__await=function(t){return this instanceof __await?(this.v=t,this):new __await(t)},__asyncGenerator=function(t,e,n){function i(t){c[t]&&(l[t]=function(e){return new Promise(function(n,i){h.push([t,e,n,i])>1||r(t,e)})})}function r(t,e){try{o(c[t](e))}catch(n){u(h[0][3],n)}}function o(t){t.value instanceof __await?Promise.resolve(t.value.v).then(s,a):u(h[0][2],t)}function s(t){r("next",t)}function a(t){r("throw",t)}function u(t,e){t(e),h.shift(),h.length&&r(h[0][0],h[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l,c=n.apply(t,e||[]),h=[];return l={},i("next"),i("throw"),i("return"),l[Symbol.asyncIterator]=function(){return this},l},__asyncDelegator=function(t){function e(e,r){n[e]=t[e]?function(n){return(i=!i)?{value:__await(t[e](n)),done:"return"===e}:r?r(n):n}:r}var n,i;return n={},e("next"),e("throw",function(t){throw t}),e("return"),n[Symbol.iterator]=function(){return this},n},__asyncValues=function(t){function e(e){i[e]=t[e]&&function(i){return new Promise(function(r,o){i=t[e](i),n(r,o,i.done,i.value)})}}function n(t,e,n,i){Promise.resolve(i).then(function(e){t({value:e,done:n})},e)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),i={},e("next"),e("throw"),e("return"),i[Symbol.asyncIterator]=function(){return this},i)},__makeTemplateObject=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__setModuleDefault=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t["default"]=e},__importStar=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&__createBinding(e,t,n);return __setModuleDefault(e,t),e},__importDefault=function(t){return t&&t.__esModule?t:{"default":t}},__classPrivateFieldGet=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet=function(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n},__reflect=function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n};!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)e.d(i,r,function(e){return t[e]}.bind(null,r));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){n(1),n(2),n(0),n(3),n(4),n(5),n(6),n(7),n(8),n(9),n(10),n(11),n(12),n(13),n(14),n(15),n(16),n(17),n(18),n(19),n(20),n(21),n(22);var i;!function(t){t[t.NULL=0]="NULL",t[t.LEVEL=1]="LEVEL",t[t.GAME=2]="GAME",t[t.WAITING=3]="WAITING",t[t.COVER=4]="COVER"}(i||(i={})),window.MainState=i;var r=function(t){function e(){var n=t.call(this)||this;n.state=i.NULL,n.lastState=i.NULL,n.frameNum=0,n.lastTime=0,n.sortableChildren=!0,egret.ImageLoader.crossOrigin="anonymous",platform.onAudioInterruptionBegin(onAudioInterruptionBegin),platform.onAudioInterruptionEnd(onAudioInterruptionEnd);var r=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",r),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter);var o=egret.MainContext.instance.stage;return n.sortableChildren=!0,n.width=o.stageWidth,n.height=n.width/640*1136,n.y=o.stageHeight/2-n.height/2,console.log("视图宽高："+n.width+" "+n.height),MyStorage.Inst,e._inst=n,n.SwitchState(i.NULL),n.once(egret.Event.ADDED_TO_STAGE,n.Start,n),n}return __extends(e,t),Object.defineProperty(e,"Inst",{get:function(){return e._inst},enumerable:!1,configurable:!0}),e.prototype.Start=function(t){return __awaiter(this,void 0,void 0,function(){var t,n,r=this;return __generator(this,function(o){switch(o.label){case 0:return t=new egret.TextField,t.fontFamily=e.font,t.text=" ",t.textColor=0,this.addChild(t),n=this,egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){console.log("egret.lifecycle.onPause"),egret.ticker.pause(),onAudioInterruptionBegin()},egret.lifecycle.onResume=function(){console.log("egret.lifecycle.onResume"),egret.ticker.resume(),onAudioInterruptionEnd()},[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return o.sent(),[4,new Promise(function(t,e){var n=new eui.Theme("resource/default.thm.json",r.stage);n.once(eui.UIEvent.COMPLETE,function(){t(0)},r)})];case 2:return o.sent(),[4,Util.LoadGroupRes(["common"])];case 3:return o.sent(),this.addChild(Scene.Common.Inst),Scene.Common.Inst.Start(),this.SwitchState(i.GAME),SoundMain.Inst.Start(),platform.gameReady(),this.lastTime=(new Date).getTime(),this.addEventListener(egret.Event.ENTER_FRAME,this.Update,this),[2]}})})},e.SetFont=function(t){for(var n=t.numChildren,i=0;n>i;i++){var r=t.getChildAt(i);r instanceof egret.DisplayObjectContainer?e.SetFont(r):r instanceof eui.Label&&(r.fontFamily=e.font)}},e.prototype.SwitchState=function(t,n){return __awaiter(this,void 0,void 0,function(){var n,r;return __generator(this,function(o){switch(o.label){case 0:switch(n=this,null!=n.scene&&(n.removeChild(n.scene),n.scene.Stop(),n.scene=null),r=null,t){case i.GAME:r=new Scene.Game.Main;break;case i.COVER:platform.showInterstitialAd(),r=new Scene.Cover.Main;break;case i.LEVEL:}return n.state!=i.WAITING&&(n.lastState=n.state),n.state=i.WAITING,null==r?[3,2]:(r.width=n.width,r.height=n.height,n.addChild(r),e.SetFont(r),r.zIndex=10,r.x=n.width/2-r.width/2,r.y=n.height/2-r.height/2,[4,r.Start()]);case 1:o.sent(),n.scene=r,n.state=t,o.label=2;case 2:return[2]}})})},e.prototype.Update=function(){var t=(new Date).getTime(),e=(t-this.lastTime)/1e3;e>.036&&(e=.036),this.lastTime=t,this.frameNum++,null!=this.scene&&this.scene.Update(e),platform.Update(e)},e._inst=null,e.font="myfont",e}(egret.DisplayObjectContainer);window.Main=r,__reflect(r.prototype,"Main",[]);var o=r;window.GMain=o},function(t,e){var n=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?i(r):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();window.AssetAdapter=n,__reflect(n.prototype,"AssetAdapter",["eui.IAssetAdapter"])},function(t,e){var n=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);window.LoadingUI=n,__reflect(n.prototype,"LoadingUI",["RES.PromiseTaskReporter"])},function(t,e){var n=function(){function t(){this.bgmOn=1,this.soundOn=1,this.Init(),this.InitSetting()}return Object.defineProperty(t,"Inst",{get:function(){if(null==t._inst){var e=new t;t._inst=e}return t._inst},enumerable:!1,configurable:!0}),t.prototype.Init=function(){var t=localStorage.getItem("choujiang_storage"),e=null;null!=t&&""!=t&&(e=JSON.parse(t)),null==e&&(e={openid:null}),this.openid=e.openid},t.prototype.InitSetting=function(){var t=localStorage.getItem("choujiang_setting"),e=null;null!=t&&""!=t&&(e=JSON.parse(t)),null==e&&(e={sound:this.soundOn,bgm:this.bgmOn}),this.soundOn=e.sound,null==this.soundOn&&(this.soundOn=1),this.bgmOn=e.bgm,null==this.bgmOn&&(this.bgmOn=1)},t.prototype.SaveSetting=function(){var t={sound:this.soundOn,bgm:this.bgmOn};localStorage.setItem("choujiang_setting",JSON.stringify(t))},t.prototype.Save=function(){var t={openid:this.openid};localStorage.setItem("choujiang_storage",JSON.stringify(t))},t.maxPower=99,t.maxLv=9,t.curGun=0,t}();window.MyStorage=n,__reflect(n.prototype,"MyStorage",[])},function(t,e){var n=function(){function t(){}return t.prototype.Update=function(t){},t.prototype.naviTo=function(t){},t.prototype.getUserInfo=function(){},t.prototype.showCustomAd=function(){},t.prototype.hideCustomAd=function(){},t.prototype.OpenID=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t){setTimeout(t,1e3)})];case 1:return t.sent(),[2,"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})]}})})},t.prototype.showAskModel=function(t,e,n,i){setTimeout(n,200)},t.prototype.showRewardedVideoAd=function(t,e){setTimeout(function(){t(!0)},100)},t.prototype.showBanner=function(){},t.prototype.hideBanner=function(){},t.prototype.onAudioInterruptionBegin=function(t){},t.prototype.onAudioInterruptionEnd=function(t){},t.prototype.showToast=function(t){},t.prototype.moreGame=function(){},t.prototype.subPackage=function(t){return 0},t.prototype.showInterstitialAd=function(){},t.prototype.gameReady=function(){},t.prototype.RECStart=function(){},t.prototype.RECStop=function(){},t}();window.DebugPlatform=n,__reflect(n.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new n)},function(t,e){function n(){0!=o.Inst.soundReady&&(console.log("onAudioInterruptionBegin: "+o.Inst.NoChannel),0==o.Inst.NoChannel&&(console.log("audio stop"),o.Inst.NoChannel=!0,o.Inst.Stop()))}function i(){0!=o.Inst.soundReady&&(console.log("onAudioInterruptionEnd: "+o.Inst.NoChannel),1==o.Inst.NoChannel&&(console.log("audio resume."),o.Inst.NoChannel=!1,o.Inst.Resume()))}var r={Click:["button_mp3",200,0],Jiang:["jiangjun_mp3",200,0],Select:["select_mp3",200,0],Put:["put_mp3",200,0]};window.SoundEffect=r;var o=function(){function t(){this.NoChannel=!1,this.soundReady=!1}return Object.defineProperty(t,"Inst",{get:function(){if(null==t._inst){var e=new t;t._inst=e}return t._inst},enumerable:!1,configurable:!0}),t.prototype.PlaySound=function(t){if(0!=this.Sound&&0!=this.soundReady){if(t[1]>0){var e=(new Date).getTime();if(e-t[2]<t[1])return;t[2]=e}if(1!=this.NoChannel){var n=t[0];console.log("play: "+n);var i=RES.getRes(n);return null==i?void console.warn("音效:"+n+"未加载."):void i.play(0,1)}}},t.prototype.PlayBGM=function(t){void 0===t&&(t="bgm_mp3"),null==this._bgm&&(this._bgm=RES.getRes(t),this._bgm.type=egret.Sound.MUSIC,this._lastBGMPos=0),1!=this.NoChannel&&(this._bgmChannel=this._bgm.play(0),this._bgmChannel.volume=1==this.BGM?.6:0)},Object.defineProperty(t.prototype,"Sound",{get:function(){return 1==MyStorage.Inst.soundOn},set:function(t){MyStorage.Inst.soundOn=1==t?1:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"BGM",{get:function(){return 1==MyStorage.Inst.bgmOn},set:function(t){MyStorage.Inst.bgmOn=1==t?1:0,MyStorage.Inst.SaveSetting(),0!=this.soundReady&&(this._bgmChannel.volume=1==t?.6:0)},enumerable:!1,configurable:!0}),t.prototype.Stop=function(){null!=this._bgmChannel&&(this._bgmChannel.removeEventListener(egret.Event.SOUND_COMPLETE,this.onBGMComplete,this),this._lastBGMPos=this._bgmChannel.position,this._bgmChannel.stop(),this._bgmChannel=null)},t.prototype.Resume=function(){null!=this._bgmChannel&&(this._lastBGMPos=this._bgmChannel.position,this._bgmChannel.stop(),this._bgmChannel=null),null==this._lastBGMPos&&(this._lastBGMPos=0),0!=this._lastBGMPos&&this._lastBGMPos<this._bgm.length?(this._bgmChannel=this._bgm.play(this._lastBGMPos,1),this._bgmChannel.once(egret.Event.SOUND_COMPLETE,this.onBGMComplete,this)):this._bgmChannel=this._bgm.play(0),this._bgmChannel.volume=1==this.BGM?.6:0},t.prototype.onBGMComplete=function(){this._bgmChannel.stop(),this._bgmChannel=this._bgm.play(0),this._bgmChannel.volume=1==this.BGM?.6:0},t.prototype.Start=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),t=0,[4,platform.subPackage("sound")];case 1:return t!=n.sent()?[3,3]:[4,RES.loadGroup("sound")];case 2:n.sent(),this.PlayBGM(),this.soundReady=!0,n.label=3;case 3:return[3,5];case 4:return e=n.sent(),[3,5];case 5:return[2]}})})},t}();window.SoundMain=o,__reflect(o.prototype,"SoundMain",[]),window.onAudioInterruptionBegin=n,window.onAudioInterruptionEnd=i},function(t,e){var n=function(){function t(){}return t.prototype.getTheme=function(t,e,n,i){function r(t){e.call(i,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(i))}var s=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(i,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,n){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(i,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var a=t.split("/");a.pop();var u=a.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(i,generateJSON.paths[t])},this):RES.getResByUrl(u,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){e.call(i,generateJSON.paths[t])},s)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(i,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();window.ThemeAdapter=n,__reflect(n.prototype,"ThemeAdapter",["eui.IThemeAdapter"])},function(t,e){var n=function(){function t(){}return t.LoadGroupRes=function(t){return __awaiter(this,void 0,void 0,function(){var e,n,i;return __generator(this,function(r){switch(r.label){case 0:for(e=[],n=0;n<t.length;n++)i=t[n],0==RES.isGroupLoaded(i)&&e.push(RES.loadGroup(i));return[4,Promise.all(e)];case 1:return r.sent(),[2]}})})},t.zeroPad=function(t,e){return("000000"+t).slice(-e)},t.Normalize=function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return 0==e?0:(t[0]/=e,t[1]/=e,e)},t.LoadRes=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return __awaiter(this,void 0,void 0,function(){var e,n,i;return __generator(this,function(r){switch(r.label){case 0:for(e=[],n=function(n){e.push(new Promise(function(e,i){RES.getResByUrl(t[n],e,null,RES.ResourceItem.TYPE_JSON)}))},i=0;i<t.length;i++)n(i);return[4,Promise.all(e)];case 1:return r.sent(),[2]}})})},t.DestroyGroupRes=function(t){return __awaiter(this,void 0,void 0,function(){var e,n,i;return __generator(this,function(r){switch(r.label){case 0:for(e=[],n=0;n<t.length;n++)i=t[n],1==RES.isGroupLoaded(i)&&e.push(RES.destroyRes(i,!0));return[4,Promise.all(e)];case 1:return r.sent(),[2]}})})},t.Clamp=function(t,e,n){return e>t?t=e:t>n&&(t=n),t},t.Dist=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},t.VecLength=function(t,e){return Math.sqrt(t*t+e*e)},t.AskFor=function(t,e){null!=e&&e()},t.RandomRange=function(t,e){return t>=e?t:Math.round(Math.random()*(e-t))+t},t.RegistBtnAnim=function(e){e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onBtnDown,null),e.addEventListener(egret.TouchEvent.TOUCH_CANCEL,t.onBtnUp,null),e.addEventListener(egret.TouchEvent.TOUCH_END,t.onBtnUp,null),e.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t.onBtnUp,null)},t.UnregistBtnAnim=function(e){e.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onBtnDown,null),e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,t.onBtnUp,null),e.removeEventListener(egret.TouchEvent.TOUCH_END,t.onBtnUp,null),e.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t.onBtnUp,null)},t.onBtnDown=function(t){egret.Tween.removeTweens(t.target),egret.Tween.get(t.target).to({scaleX:1.1,scaleY:1.1},100)},t.onBtnUp=function(t){egret.Tween.removeTweens(t.target),egret.Tween.get(t.target).to({scaleX:1,scaleY:1},100)},t}();window.Util=n,__reflect(n.prototype,"Util",[])},function(t,e){var n=window.Scene;window.Scene=n},function(t,e){var n,n=window.Scene;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inited=!1,e}return __extends(e,t),Object.defineProperty(e,"Inst",{get:function(){if(null==e._inst){var t=new e;e._inst=t}return e._inst},enumerable:!1,configurable:!0}),e.prototype.Start=function(){this.inited=!0,this.zIndex=999},e.prototype.Update=function(t){},e}(eui.Component);t.Common=e,__reflect(e.prototype,"Scene.Common",["eui.UIComponent"])}(n||(n={})),window.Scene=n},function(t,e){var n;!function(t){t[t.NowTime=0]="NowTime",t[t.Login=1]="Login",t[t.BeginAdTicket=2]="BeginAdTicket",t[t.EndAdTicket=3]="EndAdTicket",t[t.BuyLotto=4]="BuyLotto",t[t.AllTicket=5]="AllTicket",t[t.AllWinner=6]="AllWinner",t[t.Rank=7]="Rank",t[t.UserInfo=8]="UserInfo",t[t.MyTicket=9]="MyTicket",t[t.Reset=10]="Reset"}(n||(n={})),window.MSGID=n;var i,i=window.Scene;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"Inst",{get:function(){return null==t._inst&&(t._inst=new t),t._inst},enumerable:!1,configurable:!0}),t.prototype.Start=function(){},t.prototype.Request=function(t,e){return void 0===e&&(e=null),__awaiter(this,void 0,void 0,function(){var n,i,r,o,s;return __generator(this,function(a){switch(a.label){case 0:return n=new egret.HttpRequest,n.responseType=egret.HttpResponseType.TEXT,n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.open("https://doge.rberme.com:4434/",egret.HttpMethod.POST),r=function(t){n.removeEventListener(egret.IOErrorEvent.IO_ERROR,o,null);var e=t.currentTarget;if(null!=e.response&&""!=e.response){var r=JSON.parse(e.response);i(r)}else console.log(e.response)},o=function(t){n.removeEventListener(egret.Event.COMPLETE,r,null),i(null)},n.once(egret.Event.COMPLETE,r,null),n.once(egret.IOErrorEvent.IO_ERROR,o,null),null==e?[3,1]:(i=e,n.send(JSON.stringify(t)),[2,null]);case 1:return[4,new Promise(function(e){i=e,n.send(JSON.stringify(t))})];case 2:return s=a.sent(),[2,s]}})})},t.prototype.Update=function(){},t}();t.Conn=e,__reflect(e.prototype,"Scene.Conn",[])}(i||(i={})),window.Scene=i},function(t,e){var n,n=window.Scene;!function(t){var e,e=window.Cover;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.Start=function(){},e.prototype.Update=function(t){},e.prototype.Stop=function(){},e}(eui.Component);t.Main=e,__reflect(e.prototype,"Scene.Cover.Main",["eui.UIComponent","Base"])}(e=t.Cover||(t.Cover={})),window.Cover=e}(n||(n={})),window.Scene=n},function(t,e){var n,n=window.Scene;!function(t){var e,e=window.Game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.inited=!1,t.inited=!1,t}return __extends(n,e),Object.defineProperty(n,"Inst",{get:function(){if(null==n._inst){var t=new n;n._inst=t}return n._inst},enumerable:!1,configurable:!0}),n.prototype.Start=function(e,i){return __awaiter(this,void 0,void 0,function(){var r,o,s,a,u=this;return __generator(this,function(l){switch(l.label){case 0:return e.addChild(this),this.zIndex=998,0==this.inited&&(GMain.SetFont(this),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,Util.RegistBtnAnim(this.img_close),this.lst_0.itemRenderer=t.TicketBar,this.lst_0.useVirtualLayout=!0),this.x=e.width/2,this.y=e.height/2,t.TicketBar.typ=3,(null==this.data||this.data.length!=i.length)&&(r=[],r.length=i.length,this.data=new eui.ArrayCollection(r),n.curTicketsNum=this.data.length),this.lst_0.dataProvider=this.data,this.grp_main.alpha=0,this.grp_main.scaleX=this.grp_main.scaleY=.5,egret.Tween.get(this.grp_main).to({alpha:1,scaleX:1,scaleY:1},300,egret.Ease.backOut),this.rt_bg.alpha=0,[4,new Promise(function(t){egret.Tween.get(u.rt_bg).to({alpha:.6},300).call(t)})];case 1:return l.sent(),s=function(){SoundMain.Inst.PlaySound(SoundEffect.Click),o(6)},this.img_close.once(egret.TouchEvent.TOUCH_TAP,s,null),[4,new Promise(function(t){o=t})];case 2:return a=l.sent(),egret.Tween.get(this.grp_main).to({alpha:0,scaleX:.5,scaleY:.5},200,egret.Ease.sineIn),[4,new Promise(function(t){egret.Tween.get(u.rt_bg).to({alpha:0},200).call(t)})];case 3:return l.sent(),IconPool.Inst.ClearWaiting(),this.lst_0.dataProvider=null,e.removeChild(this),[2,a]}})})},n.curTicketsNum=0,n}(eui.Component);t.AllTicket=e,__reflect(e.prototype,"Scene.Game.AllTicket",["eui.UIComponent"])}(e=t.Game||(t.Game={})),window.Game=e}(n||(n={})),window.Scene=n},function(t,e){var n,n=window.Scene;!function(t){var e,e=window.Game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.inited=!1,e.inited=!1,e}return __extends(e,t),Object.defineProperty(e,"Inst",{get:function(){if(null==e._inst){var t=new e;e._inst=t}return e._inst},enumerable:!1,configurable:!0}),e.prototype.Start=function(t){return __awaiter(this,void 0,void 0,function(){var e,n,i,r=this;return __generator(this,function(o){switch(o.label){case 0:return t.addChild(this),this.zIndex=998,0==this.inited&&(GMain.SetFont(this),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,Util.RegistBtnAnim(this.img_close)),this.x=t.width/2,this.y=t.height/2,this.grp_main.alpha=0,this.grp_main.scaleX=this.grp_main.scaleY=.5,egret.Tween.get(this.grp_main).to({alpha:1,scaleX:1,scaleY:1},300,egret.Ease.backOut),this.rt_bg.alpha=0,[4,new Promise(function(t){egret.Tween.get(r.rt_bg).to({alpha:.6},300).call(t)})];case 1:return o.sent(),n=function(){SoundMain.Inst.PlaySound(SoundEffect.Click),e(6)},this.img_close.once(egret.TouchEvent.TOUCH_TAP,n,null),[4,new Promise(function(t){e=t})];case 2:return i=o.sent(),egret.Tween.get(this.grp_main).to({alpha:0,scaleX:.5,scaleY:.5},200,egret.Ease.sineIn),[4,new Promise(function(t){egret.Tween.get(r.rt_bg).to({alpha:0},200).call(t)})];case 3:return o.sent(),t.removeChild(this),[2,i]}})})},e}(eui.Component);t.Help=e,__reflect(e.prototype,"Scene.Game.Help",["eui.UIComponent"])}(e=t.Game||(t.Game={})),window.Game=e}(n||(n={})),window.Scene=n},function(t,e){var n=function(){function t(){this.inited=!1,this.iconMap=new Map,this.imgWaiting=new Map,this.inited=!1}return Object.defineProperty(t,"Inst",{get:function(){if(null==t._inst){var e=new t;t._inst=e}return t._inst},enumerable:!1,configurable:!0}),t.prototype.SetIcon=function(t,e){var n=this;return null==e||""==e||"null"==e?void(t.texture=RES.getRes("icon_null_png")):1==this.iconMap.has(e)?void(t.texture=this.iconMap.get(e)):(this.imgWaiting.set(t,e),void RES.getResByUrl(e,function(i){n.iconMap.set(e,i),n.imgWaiting.get(t)==e&&(t.texture=i)},null,RES.ResourceItem.TYPE_IMAGE))},t.prototype.ClearWaiting=function(){this.imgWaiting.clear()},t.prototype.Clear=function(){this.iconMap.clear()},t}();window.IconPool=n,__reflect(n.prototype,"IconPool",[])},function(t,e){var n=function(){function t(){this.color=0}return Object.defineProperty(t,"Inst",{get:function(){if(null==t._inst){var e=new t;t._inst=e}return t._inst},enumerable:!1,configurable:!0}),t.prototype.simpleHash=function(e){return e.split("").reduce(function(e,n){return(e^n.charCodeAt(0))*-t.MAGIC_NUMBER},t.MAGIC_NUMBER)>>>2},t.prototype.minidenticon=function(e,n,i,r){var o;void 0===e&&(e=""),void 0===n&&(n=t.DEFAULT_SATURATION),void 0===i&&(i=t.DEFAULT_LIGHTNESS),void 0===r&&(r=this.simpleHash);var s=r(e),a=s%t.COLORS_NB*(360/t.COLORS_NB),u=[];__spread(Array(e?25:0)).reduce(function(t,e,n){if((s&1<<n%15)>0){var i=n>14?7-~~(n/5):~~(n/5),r=n%5;u[i+5*r]=1}},0),this.color=this.hslToRgb(a,n/100,i/100);for(var l=1,c=l+": ",h=0;h<u.length;h++)h%5==0&&h>0&&(console.log(c),l++,c=l+": "),c+=(null!==(o=u[h])&&void 0!==o?o:0)+" ";return u},t.prototype.hslToRgb=function(t,e,n){t=(t%360+360)%360,e=Math.max(0,Math.min(1,e)),n=Math.max(0,Math.min(1,n));var i=(1-Math.abs(2*n-1))*e,r=i*(1-Math.abs(t/60%2-1)),o=n-i/2,s=0,a=0,u=0;t>=0&&60>t?(s=i,a=r,u=0):t>=60&&120>t?(s=r,a=i,u=0):t>=120&&180>t?(s=0,a=i,u=r):t>=180&&240>t?(s=0,a=r,u=i):t>=240&&300>t?(s=r,a=0,u=i):t>=300&&360>t&&(s=i,a=0,u=r);var l=Math.round(255*(s+o))<<16|Math.round(255*(a+o))<<8|Math.round(255*(u+o));return l},t.prototype.Draw=function(t,e){var n=this.minidenticon(t),i=e.width/5,r=e.height/5;e.graphics.beginFill(15658734),e.graphics.drawRect(0,0,e.width,e.height),e.graphics.endFill(),e.graphics.beginFill(this.color);for(var o=0;25>o;o++){var s=o%5,a=Math.floor(o/5),u=n[o];u>0&&e.graphics.drawRect(s*i,a*r,i,r)}e.graphics.endFill()},t.COLORS_NB=9,t.DEFAULT_SATURATION=95,t.DEFAULT_LIGHTNESS=45,t.MAGIC_NUMBER=5,t}();window.IdentIcon=n,__reflect(n.prototype,"IdentIcon",[])},function(t,e){var n,n=window.Scene;!function(t){var e,e=window.Game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.inited=!1,e.inited=!1,e}return __extends(e,t),Object.defineProperty(e,"Inst",{get:function(){if(null==e._inst){var t=new e;e._inst=t}return e._inst},enumerable:!1,configurable:!0}),e.prototype.Start=function(){return __awaiter(this,void 0,void 0,function(){var t,e,n,i=this;return __generator(this,function(r){switch(r.label){case 0:return GMain.Inst.addChild(this),this.zIndex=998,0==this.inited&&(GMain.SetFont(this),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.et_addr.maxChars=34,this.et_addr.fontFamily=GMain.font,Util.RegistBtnAnim(this.img_ok)),this.x=this.parent.width/2,this.y=this.parent.height/2,this.onTextChange(),this.grp_main.alpha=0,this.grp_main.scaleX=this.grp_main.scaleY=.5,egret.Tween.get(this.grp_main).to({alpha:1,scaleX:1,scaleY:1},300,egret.Ease.backOut),this.rt_bg.alpha=0,[4,new Promise(function(t){egret.Tween.get(i.rt_bg).to({alpha:.6},300).call(t)})];case 1:return r.sent(),e=function(){SoundMain.Inst.PlaySound(SoundEffect.Click);var e=i.et_addr.text;t(e)},this.et_addr.addEventListener(egret.Event.CHANGE,this.onTextChange,this),this.img_ok.addEventListener(egret.TouchEvent.TOUCH_TAP,e,null),[4,new Promise(function(e){t=e})];case 2:return n=r.sent(),this.et_addr.removeEventListener(egret.Event.CHANGE,this.onTextChange,this),this.img_ok.removeEventListener(egret.TouchEvent.TOUCH_TAP,e,null),egret.Tween.get(this.grp_main).to({alpha:0,scaleX:.5,scaleY:.5},200,egret.Ease.sineIn),[4,new Promise(function(t){egret.Tween.get(i.rt_bg).to({alpha:0},200).call(t)})];case 3:return r.sent(),this.parent.removeChild(this),[2,n]}})})},e.prototype.availableChar=function(t){for(var e=0;e<t.length;e++)if(0==/[A-Za-z0-9]/.test(t[e]))return!1;return!0},e.prototype.onTextChange=function(){var t=this.et_addr.text;""==t||null==t||34!=t.length||0==this.availableChar(t)?(this.img_ok.touchEnabled=!1,this.img_ok.alpha=.5):(this.img_ok.touchEnabled=!0,this.img_ok.alpha=1)},e}(eui.Component);t.InputAddr=e,__reflect(e.prototype,"Scene.Game.InputAddr",["eui.UIComponent"])}(e=t.Game||(t.Game={})),window.Game=e}(n||(n={})),window.Scene=n},function(t,e){var n,n=window.Scene;!function(t){var e,e=window.Game;!function(e){var n=function(n){function i(){var t=n.call(this)||this;return t._gameLeftTime=0,t.state=0,t.timingInterval=5,t.curTimingInterval=0,t.updateTiming=!1,t.allTickets=[],t.myTickets=[],t.beforeTicketIdx=0,t.ticketRequesting=!1,t.winners=[],t}return __extends(i,n),Object.defineProperty(i.prototype,"buyNum",{get:function(){return this._buyNum},set:function(t){this.lbl_allmoney.text=Math.round(t).toString(),this.lbl_money0.text=Math.round(.8*t).toString(),this.lbl_money1.text=Math.round(.15*t).toString(),this.lbl_money2.text=Math.round(.05*t).toString(),this._buyNum=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"ticket",{get:function(){return this._ticket},set:function(t){this.lbl_ticket.text=t.toString(),this._ticket=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"money",{get:function(){return this._money},set:function(t){this.lbl_money.text=t.toString(),this._money=t
},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"gameLeftTime",{get:function(){return this._gameLeftTime},set:function(t){var e=Math.max(0,t),n=Math.floor(e/3600);e-=3600*n;var i=Math.floor(e/60);e-=60*i;var r=Math.floor(e);this.lbl_countdown.text=Util.zeroPad(n,2)+":"+Util.zeroPad(i,2)+":"+Util.zeroPad(r,2),this._gameLeftTime=t},enumerable:!1,configurable:!0}),i.prototype.Start=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return i.Inst=this,Util.RegistBtnAnim(this.grp_buy),Util.RegistBtnAnim(this.grp_allticket),Util.RegistBtnAnim(this.grp_myticket),Util.RegistBtnAnim(this.grp_winrec),Util.RegistBtnAnim(this.grp_help),Util.RegistBtnAnim(this.grp_rank),Util.RegistBtnAnim(this.grp_ticket),[4,this.UpdateTime()];case 1:return n.sent(),this.myopenid=MyStorage.Inst.openid,null!=this.myopenid&&""!=this.myopenid?[3,3]:[4,e.InputAddr.Inst.Start()];case 2:t=n.sent(),MyStorage.Inst.openid=t,MyStorage.Inst.Save(),this.myopenid=t,n.label=3;case 3:return console.log("openid: "+this.myopenid),[4,this.UpdateMyTickets()];case 4:return n.sent(),this.grp_ticket.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapAdTicket,this),this.grp_buy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapBuyLotto,this),this.grp_allticket.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapAllTickets,this),this.grp_myticket.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapMyTickets,this),this.grp_winrec.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapWinner,this),this.grp_help.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapHelp,this),this.grp_rank.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapRank,this),[4,this.Reset()];case 5:return n.sent(),[2]}})})},i.prototype.UpdateUserData=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(n){switch(n.label){case 0:return[4,t.Conn.Inst.Request([MSGID.Login,this.myopenid,this.myNick,this.myIcon])];case 1:return e=n.sent(),null==e?[2]:(this.ticket=e[0],this.money=e[1],this.myNick=e[2],this.myIcon=e[3],[2])}})})},i.prototype.UpdateTime=function(){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(i){switch(i.label){case 0:return this.updateTiming=!0,[4,t.Conn.Inst.Request([MSGID.NowTime])];case 1:return e=i.sent(),this.updateTiming=!1,null==e?[2]:(n=new Date(e[0]),this.gameLeftTime=86400-(e[0]-new Date(n.getFullYear(),n.getMonth(),n.getDate()).getTime())/1e3,this.buyNum=e[1],[2])}})})},i.prototype.UpdateAdTicket=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(n){switch(n.label){case 0:return console.log("UpdateAdTicket"),[4,t.Conn.Inst.Request([MSGID.EndAdTicket,this.myopenid])];case 1:return e=n.sent(),null==e?[2]:(this.ticket=e[0],[2])}})})},i.prototype.onTapAdTicket=function(){var e=this;t.Conn.Inst.Request([MSGID.BeginAdTicket,this.myopenid]),platform.showRewardedVideoAd(function(t){1==t&&e.UpdateAdTicket()},function(){})},i.prototype.onTapBuyLotto=function(){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(i){switch(i.label){case 0:return null!=this.myIcon&&""!=this.myIcon&&"null"!=this.myIcon?[3,2]:[4,platform.getUserInfo()];case 1:e=i.sent(),null!=e&&(this.myNick=e.nickName,this.myIcon=e.avatarUrl,t.Conn.Inst.Request([MSGID.UserInfo,this.myopenid,this.myNick,this.myIcon])),console.log(this.myIcon),i.label=2;case 2:return this.ticket<=0?[2]:[4,t.Conn.Inst.Request([MSGID.BuyLotto,this.myopenid])];case 3:return n=i.sent(),null==n?[2]:(this.ticket=n[0],this.buyNum=n[1],this.UpdateMyTickets(),[2])}})})},i.prototype.UpdateMyTickets=function(){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(i){switch(i.label){case 0:return[4,t.Conn.Inst.Request([MSGID.MyTicket,this.myopenid])];case 1:if(e=i.sent(),null==e)return[2];for(n=0;n<e.length;n++)this.AddMyTicket(e[n]);return this.UpdateTicketData(),[2]}})})},i.prototype.AddMyTicket=function(t){for(var e=0;e<this.myTickets.length;e++)if(this.myTickets[e][1]==t[1])return;this.myTickets.push(t)},i.prototype.StartAllTickets=function(){return __awaiter(this,void 0,void 0,function(){var e,n,i;return __generator(this,function(r){switch(r.label){case 0:this.allTickets.length=this.buyNum,this.beforeTicketIdx=this.buyNum,e=100*Math.floor(this.beforeTicketIdx/100),r.label=1;case 1:return e>=0?[4,t.Conn.Inst.Request([MSGID.AllTicket,e])]:[3,4];case 2:if(n=r.sent(),null!=n){for(i=0;i<n.length;i++)this.allTickets[e+i]=n[i],n[i].push(e+i),n[i][0]==this.myopenid&&this.AddMyTicket(n[i]);e-=100}return[4,new Promise(function(t){egret.setTimeout(t,null,1e3)})];case 3:return r.sent(),[3,1];case 4:return console.log("AllTickets load end."),this.UpdateTicketData(),[2]}})})},i.prototype.UpdateAllTickets=function(){return __awaiter(this,void 0,void 0,function(){var e,n,i,r;return __generator(this,function(o){switch(o.label){case 0:return 1==this.ticketRequesting?[2]:this.allTickets.length<this.buyNum?(console.log("request ticket data."),this.ticketRequesting=!0,e=this.allTickets.length,[4,t.Conn.Inst.Request([MSGID.AllTicket,e])]):[3,2];case 1:if(n=o.sent(),this.ticketRequesting=!1,null==n)return[2];for(i=0;i<n.length;i++)n[i].push(e+i),n[i][0]==this.myopenid&&this.AddMyTicket(n[i]);(r=this.allTickets).push.apply(r,__spread(n)),this.UpdateTicketData(),o.label=2;case 2:return[2]}})})},i.prototype.UpdateTicketData=function(){this.lbl_myticket.text="Tickets:\n"+this.myTickets.length+"/"+this.buyNum;var t=this.buyNum<=0?0:1-Math.pow(1-this.myTickets.length/this.buyNum,3);this.lbl_myrate.text="Chance:\n"+Math.round(1e4*t)/100+"%"},i.prototype.onTapAllTickets=function(){e.AllTicket.Inst.Start(GMain.Inst,this.allTickets)},i.prototype.onTapMyTickets=function(){this.myTickets.sort(function(t,e){return e[4]-t[4]}),e.MyTicket.Inst.Start(GMain.Inst,this.myTickets)},i.prototype.onTapHelp=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return console.log("onTapHelp."),e.Help.Inst.Start(GMain.Inst),[2]})})},i.prototype.onTapRank=function(){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(i){switch(i.label){case 0:return null!=this.rankData?[3,2]:(n=this,[4,t.Conn.Inst.Request([MSGID.Rank])]);case 1:if(n.rankData=i.sent(),null==this.rankData)return[2];i.label=2;case 2:return e.Rank.Inst.Start(GMain.Inst,this.rankData),[2]}})})},i.prototype.onTapWinner=function(){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(i){switch(i.label){case 0:return null==this.winners||this.winners.length<=0?(n=this,[4,t.Conn.Inst.Request([MSGID.AllWinner])]):[3,2];case 1:if(n.winners=i.sent(),null==this.winners)return[2];i.label=2;case 2:return e.Winner.Inst.Start(GMain.Inst,this.winners),[2]}})})},i.prototype.Update=function(t){switch(0==this.updateTiming&&(this.curTimingInterval>this.timingInterval&&(this.curTimingInterval=0,this.UpdateTime()),this.curTimingInterval+=t),this.UpdateAllTickets(),this.state){case 1:var e=this.gameLeftTime-t;0>=e&&this.gameLeftTime>0?(this.state=0,this.myTickets.length=0,this.lbl_myticket.text="参与次数:\n0/0",this.lbl_myrate.text="中奖概率:\n0.00%",this.Reset(),this.gameLeftTime=0):this.gameLeftTime=e;break;case 2:}},i.prototype.Stop=function(){Util.UnregistBtnAnim(this.grp_buy),Util.UnregistBtnAnim(this.grp_allticket),Util.UnregistBtnAnim(this.grp_myticket),Util.UnregistBtnAnim(this.grp_winrec),Util.UnregistBtnAnim(this.grp_help),Util.UnregistBtnAnim(this.grp_rank),Util.UnregistBtnAnim(this.grp_ticket),this.grp_ticket.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapAdTicket,this),this.grp_buy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapBuyLotto,this),this.grp_allticket.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapAllTickets,this),this.grp_myticket.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapMyTickets,this),this.grp_winrec.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapWinner,this),this.grp_help.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapHelp,this),this.grp_rank.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTapRank,this),i.Inst=null},i.prototype.Reset=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.rankData=null,[4,Promise.all([this.UpdateUserData(),this.UpdateTime()])];case 1:return t.sent(),this.allTickets=[],IconPool.Inst.Clear(),this.StartAllTickets(),this.state=1,[2]}})})},i}(eui.Component);e.Main=n,__reflect(n.prototype,"Scene.Game.Main",["eui.UIComponent","Base"])}(e=t.Game||(t.Game={})),window.Game=e}(n||(n={})),window.Scene=n},function(t,e){var n,n=window.Scene;!function(t){var e,e=window.Game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.inited=!1,t.inited=!1,t}return __extends(n,e),Object.defineProperty(n,"Inst",{get:function(){if(null==n._inst){var t=new n;n._inst=t}return n._inst},enumerable:!1,configurable:!0}),n.prototype.Start=function(e,n){return __awaiter(this,void 0,void 0,function(){var i,r,o,s=this;return __generator(this,function(a){switch(a.label){case 0:return e.addChild(this),this.zIndex=998,0==this.inited&&(GMain.SetFont(this),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,Util.RegistBtnAnim(this.img_close),this.lst_0.itemRenderer=t.TicketBar,this.lst_0.useVirtualLayout=!0),this.x=e.width/2,this.y=e.height/2,t.TicketBar.typ=1,(null==this.data||this.data.length!=n.length)&&(this.data=new eui.ArrayCollection(n)),this.lst_0.dataProvider=this.data,this.grp_main.alpha=0,this.grp_main.scaleX=this.grp_main.scaleY=.5,egret.Tween.get(this.grp_main).to({alpha:1,scaleX:1,scaleY:1},300,egret.Ease.backOut),this.rt_bg.alpha=0,[4,new Promise(function(t){egret.Tween.get(s.rt_bg).to({alpha:.6},300).call(t)})];case 1:return a.sent(),r=function(){SoundMain.Inst.PlaySound(SoundEffect.Click),i(6)},this.img_close.once(egret.TouchEvent.TOUCH_TAP,r,null),[4,new Promise(function(t){i=t})];case 2:return o=a.sent(),egret.Tween.get(this.grp_main).to({alpha:0,scaleX:.5,scaleY:.5},200,egret.Ease.sineIn),[4,new Promise(function(t){egret.Tween.get(s.rt_bg).to({alpha:0},200).call(t)})];case 3:return a.sent(),IconPool.Inst.ClearWaiting(),this.lst_0.dataProvider=null,e.removeChild(this),[2,o]}})})},n}(eui.Component);t.MyTicket=e,__reflect(e.prototype,"Scene.Game.MyTicket",["eui.UIComponent"])}(e=t.Game||(t.Game={})),window.Game=e}(n||(n={})),window.Scene=n},function(t,e){var n,n=window.Scene;!function(t){var e,e=window.Game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.inited=!1,t.inited=!1,t}return __extends(n,e),Object.defineProperty(n,"Inst",{get:function(){if(null==n._inst){var t=new n;n._inst=t}return n._inst},enumerable:!1,configurable:!0}),n.prototype.Start=function(e,n){return __awaiter(this,void 0,void 0,function(){var i,r,o,s=this;return __generator(this,function(a){switch(a.label){case 0:return e.addChild(this),this.zIndex=998,0==this.inited&&(GMain.SetFont(this),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,Util.RegistBtnAnim(this.img_close),this.lst_0.itemRenderer=t.TicketBar,this.lst_0.useVirtualLayout=!0),this.x=e.width/2,this.y=e.height/2,t.TicketBar.typ=2,this.data=new eui.ArrayCollection(n),this.lst_0.dataProvider=this.data,this.grp_main.alpha=0,this.grp_main.scaleX=this.grp_main.scaleY=.5,egret.Tween.get(this.grp_main).to({alpha:1,scaleX:1,scaleY:1},300,egret.Ease.backOut),this.rt_bg.alpha=0,[4,new Promise(function(t){egret.Tween.get(s.rt_bg).to({alpha:.6},300).call(t)})];case 1:return a.sent(),r=function(){SoundMain.Inst.PlaySound(SoundEffect.Click),i(6)},this.img_close.once(egret.TouchEvent.TOUCH_TAP,r,null),[4,new Promise(function(t){i=t})];case 2:return o=a.sent(),egret.Tween.get(this.grp_main).to({alpha:0,scaleX:.5,scaleY:.5},200,egret.Ease.sineIn),[4,new Promise(function(t){egret.Tween.get(s.rt_bg).to({alpha:0},200).call(t)})];case 3:return a.sent(),IconPool.Inst.ClearWaiting(),this.lst_0.dataProvider=null,e.removeChild(this),[2,o]}})})},n}(eui.Component);t.Rank=e,__reflect(e.prototype,"Scene.Game.Rank",["eui.UIComponent"])}(e=t.Game||(t.Game={})),window.Game=e}(n||(n={})),window.Scene=n},function(t,e){var n,n=window.Scene;!function(t){var e,e=window.Game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._uiinited=!1,null==t.spr_icon&&(t.spr_icon=new egret.Sprite,t.spr_icon.width=t.spr_icon.height=55,t.spr_icon.anchorOffsetX=t.spr_icon.width/2,t.spr_icon.anchorOffsetY=t.spr_icon.height/2,t.spr_icon.x=111.5,t.spr_icon.y=40.5),t._uiinited=!1,t.once(eui.UIEvent.CREATION_COMPLETE,function(){console.log("TicketBar ready."),t._uiinited=!0,GMain.SetFont(t),t.updateData()},null),t.once(eui.UIEvent.REMOVED_FROM_STAGE,function(){console.log("TicketBar removed.")},null),t}return __extends(n,e),Object.defineProperty(n.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,this.updateData()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"itemIndex",{get:function(){return this._itemIndex},set:function(t){this._itemIndex=t},enumerable:!1,configurable:!0}),n.prototype.updateData=function(){if(null==this.spr_icon.parent&&this.img_icon.parent.addChildAt(this.spr_icon,0),this.img_idx.texture=null,this.img_0.texture=null,this.lbl_data.text="",this.img_icon.texture=null,this.lbl_name.text="Loading...",this.lbl_idx.text="",3==n.typ){var e=t.Main.Inst.allTickets,i=e[t.AllTicket.curTicketsNum-1-this._itemIndex];if(null==i)return;this.img_idx.texture=null,this.img_0.texture=RES.getRes("game0_json.img_9_png");var r=new Date(i[1]);return this.lbl_data.text=r.getFullYear()+"/"+(r.getMonth()+1)+"/"+r.getDate()+"\n"+Util.zeroPad(r.getHours(),2)+":"+Util.zeroPad(r.getMinutes(),2)+":"+Util.zeroPad(r.getSeconds(),2),this.img_icon.texture=null,null==i[3]||"null"==i[3]?(this.img_icon.visible=!1,this.spr_icon.visible=!0,IdentIcon.Inst.Draw(i[0],this.spr_icon)):(this.img_icon.visible=!0,this.spr_icon.visible=!1,IconPool.Inst.SetIcon(this.img_icon,i[3])),this.lbl_idx.text=i[4]+1,void(null==i[2]||""==i[2]?this.lbl_name.text=i[0].substring(0,4)+"..."+i[0].substring(i[0].length-4,i[0].length):this.lbl_name.text=i[2])}if(null!=this._data&&0!=this._uiinited)if(1==n.typ){this.img_idx.texture=null,this.img_0.texture=RES.getRes("game0_json.img_9_png");var r=new Date(this._data[1]);this.lbl_data.text=r.getFullYear()+"/"+(r.getMonth()+1)+"/"+r.getDate()+"\n"+Util.zeroPad(r.getHours(),2)+":"+Util.zeroPad(r.getMinutes(),2)+":"+Util.zeroPad(r.getSeconds(),2),this.img_icon.texture=null,null==this._data[3]||"null"==this._data[3]?(this.img_icon.visible=!1,this.spr_icon.visible=!0,IdentIcon.Inst.Draw(this._data[0],this.spr_icon)):(this.img_icon.visible=!0,this.spr_icon.visible=!1,IconPool.Inst.SetIcon(this.img_icon,this._data[3])),this.lbl_idx.text=this._data[4]+1,null==this._data[2]||""==this._data[2]?this.lbl_name.text=this._data[0].substring(0,4)+"..."+this._data[0].substring(this._data[0].length-4,this._data[0].length):this.lbl_name.text=this._data[2]}else 2==n.typ&&(this.img_0.texture=RES.getRes("game0_json.img_6_png"),this.lbl_data.text=this._data[1],this.img_icon.texture=null,null==this._data[3]||"null"==this._data[3]?(this.img_icon.visible=!1,this.spr_icon.visible=!0,IdentIcon.Inst.Draw(this._data[0],this.spr_icon)):(this.img_icon.visible=!0,this.spr_icon.visible=!1,IconPool.Inst.SetIcon(this.img_icon,this._data[3])),this.lbl_idx.text=(this._itemIndex+1).toString(),null==this._data[2]||""==this._data[2]?this.lbl_name.text=this._data[0].substring(0,4)+"..."+this._data[0].substring(this._data[0].length-4,this._data[0].length):this.lbl_name.text=this._data[2],this._itemIndex<3?0==this._itemIndex?this.img_idx.texture=RES.getRes("game0_json.img_15_png"):1==this._itemIndex?this.img_idx.texture=RES.getRes("game0_json.img_16_png"):2==this._itemIndex&&(this.img_idx.texture=RES.getRes("game0_json.img_14_png")):this.img_idx.texture=null)},n.typ=0,n}(eui.Component);t.TicketBar=e,__reflect(e.prototype,"Scene.Game.TicketBar",["eui.IItemRenderer"])}(e=t.Game||(t.Game={})),window.Game=e}(n||(n={})),window.Scene=n},function(t,e){var n,n=window.Scene;!function(t){var e,e=window.Game;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.inited=!1,t.inited=!1,t}return __extends(n,e),Object.defineProperty(n,"Inst",{get:function(){if(null==n._inst){var t=new n;n._inst=t}return n._inst},enumerable:!1,configurable:!0}),n.prototype.Start=function(e,n){return __awaiter(this,void 0,void 0,function(){var i,r,o,s=this;return __generator(this,function(a){switch(a.label){case 0:return e.addChild(this),this.zIndex=998,0==this.inited&&(GMain.SetFont(this),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,Util.RegistBtnAnim(this.img_close),this.lst_0.itemRenderer=t.WinnerBar,this.lst_0.useVirtualLayout=!0),this.x=e.width/2,this.y=e.height/2,(null==this.data||this.data.length!=n.length)&&(this.data=new eui.ArrayCollection(n)),this.lst_0.dataProvider=this.data,this.grp_main.alpha=0,this.grp_main.scaleX=this.grp_main.scaleY=.5,egret.Tween.get(this.grp_main).to({alpha:1,scaleX:1,scaleY:1},300,egret.Ease.backOut),this.rt_bg.alpha=0,[4,new Promise(function(t){egret.Tween.get(s.rt_bg).to({alpha:.6},300).call(t)})];case 1:return a.sent(),r=function(){SoundMain.Inst.PlaySound(SoundEffect.Click),i(6)},this.img_close.once(egret.TouchEvent.TOUCH_TAP,r,null),[4,new Promise(function(t){i=t})];case 2:return o=a.sent(),egret.Tween.get(this.grp_main).to({alpha:0,scaleX:.5,scaleY:.5},200,egret.Ease.sineIn),[4,new Promise(function(t){egret.Tween.get(s.rt_bg).to({alpha:0},200).call(t)})];case 3:return a.sent(),IconPool.Inst.ClearWaiting(),this.lst_0.dataProvider=null,e.removeChild(this),[2,o]}})})},n}(eui.Component);t.Winner=e,__reflect(e.prototype,"Scene.Game.Winner",["eui.UIComponent"])}(e=t.Game||(t.Game={})),window.Game=e}(n||(n={})),window.Scene=n},function(t,e){var n,n=window.Scene;!function(t){var e,e=window.Game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._uiinited=!1,e._uiinited=!1,e.once(eui.UIEvent.CREATION_COMPLETE,function(){console.log("TicketBar ready."),e._uiinited=!0,GMain.SetFont(e),e.updateData()},null),e.once(eui.UIEvent.REMOVED_FROM_STAGE,function(){console.log("TicketBar removed.")},null),e}return __extends(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,this.updateData()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemIndex",{get:function(){return this._itemIndex},set:function(t){this._itemIndex=t},enumerable:!1,configurable:!0}),e.prototype.updateData=function(){if(null!=this._data&&0!=this._uiinited){var t=new Date(this._data[0]);this.lbl_info.text=t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+"       Amount:"+this._data[1];for(var e=0;3>e;e++){var n=this._data[2+e];this["lbl_idx"+e].text=n[2]+1,this["lbl_money"+e].text=n[1],this["lbl_name"+e].text=n[3],this["img_icon"+e].texture=null,IconPool.Inst.SetIcon(this["img_icon"+e],n[4])}}},e}(eui.Component);t.WinnerBar=e,__reflect(e.prototype,"Scene.Game.WinnerBar",["eui.IItemRenderer"])}(e=t.Game||(t.Game={})),window.Game=e}(n||(n={})),window.Scene=n}]);